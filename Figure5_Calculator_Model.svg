<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 700" width="900" height="700">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1a365d"/>
      <stop offset="100%" style="stop-color:#2c5282"/>
    </linearGradient>
    <linearGradient id="bilateralGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2d3748"/>
      <stop offset="100%" style="stop-color:#1a202c"/>
    </linearGradient>
    <linearGradient id="unilateralGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2d3748"/>
      <stop offset="100%" style="stop-color:#1a202c"/>
    </linearGradient>
    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#276749"/>
      <stop offset="100%" style="stop-color:#38a169"/>
    </linearGradient>
    <linearGradient id="yellowGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#975a16"/>
      <stop offset="100%" style="stop-color:#d69e2e"/>
    </linearGradient>
    <linearGradient id="redGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#9b2c2c"/>
      <stop offset="100%" style="stop-color:#e53e3e"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="700" fill="#f7fafc"/>

  <!-- Title -->
  <rect x="50" y="20" width="800" height="50" rx="8" fill="url(#headerGrad)" filter="url(#shadow)"/>
  <text x="450" y="52" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="20" font-weight="bold">
    nTMS-based GBM Survival Prediction Calculator
  </text>

  <!-- Patient Input Box -->
  <rect x="300" y="90" width="300" height="70" rx="8" fill="#4a5568" filter="url(#shadow)"/>
  <text x="450" y="115" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="14" font-weight="bold">PATIENT DATA INPUT</text>
  <text x="450" y="138" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="11">Age, MGMT Status, Extent of Resection</text>
  <text x="450" y="152" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="11">nTMS Motor Mapping Results</text>

  <!-- Decision Diamond -->
  <polygon points="450,185 530,230 450,275 370,230" fill="#553c9a" stroke="#805ad5" stroke-width="2" filter="url(#shadow)"/>
  <text x="450" y="225" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Bilateral</text>
  <text x="450" y="238" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Mapping?</text>

  <!-- Arrows from decision -->
  <line x1="370" y1="230" x2="240" y2="230" stroke="#805ad5" stroke-width="2" marker-end="url(#arrowPurple)"/>
  <text x="305" y="220" text-anchor="middle" fill="#553c9a" font-family="Arial, sans-serif" font-size="11" font-weight="bold">YES</text>

  <line x1="530" y1="230" x2="660" y2="230" stroke="#805ad5" stroke-width="2"/>
  <text x="595" y="220" text-anchor="middle" fill="#553c9a" font-family="Arial, sans-serif" font-size="11" font-weight="bold">NO</text>

  <!-- BILATERAL MODEL BOX -->
  <rect x="50" y="260" width="380" height="240" rx="10" fill="url(#bilateralGrad)" stroke="#4299e1" stroke-width="2" filter="url(#shadow)"/>
  <rect x="50" y="260" width="380" height="35" rx="10" fill="#2b6cb0"/>
  <rect x="50" y="285" width="380" height="10" fill="url(#bilateralGrad)"/>
  <text x="240" y="283" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="14" font-weight="bold">BILATERAL MODEL (n=46)</text>

  <!-- Bilateral Variables -->
  <text x="70" y="320" fill="#90cdf4" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Input Variables:</text>

  <rect x="70" y="330" width="160" height="25" rx="4" fill="#2d3748" stroke="#4a5568" stroke-width="1"/>
  <text x="150" y="347" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="11">Age (years)</text>

  <rect x="240" y="330" width="160" height="25" rx="4" fill="#2d3748" stroke="#4a5568" stroke-width="1"/>
  <text x="320" y="347" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="11">MGMT Status</text>

  <rect x="70" y="360" width="160" height="25" rx="4" fill="#2d3748" stroke="#4a5568" stroke-width="1"/>
  <text x="150" y="377" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="11">EoR ≥95%</text>

  <rect x="240" y="360" width="160" height="25" rx="4" fill="#4299e1" stroke="#63b3ed" stroke-width="1"/>
  <text x="320" y="377" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11" font-weight="bold">CES (0-2)</text>

  <rect x="155" y="390" width="170" height="25" rx="4" fill="#4299e1" stroke="#63b3ed" stroke-width="1"/>
  <text x="240" y="407" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11" font-weight="bold">IntraM1 Tumor (LL/UL)</text>

  <!-- Bilateral Formula -->
  <text x="70" y="435" fill="#90cdf4" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Logistic Regression:</text>
  <rect x="70" y="442" width="340" height="45" rx="4" fill="#1a202c" stroke="#2d3748" stroke-width="1"/>
  <text x="240" y="460" text-anchor="middle" fill="#68d391" font-family="Courier New, monospace" font-size="9">
    logit(p) = 0.16 - 0.01×Age + 0.78×MGMT
  </text>
  <text x="240" y="478" text-anchor="middle" fill="#68d391" font-family="Courier New, monospace" font-size="9">
    + 0.70×EoR95 - 0.94×CES + 0.96×IntraM1
  </text>

  <!-- UNILATERAL MODEL BOX -->
  <rect x="470" y="260" width="380" height="240" rx="10" fill="url(#unilateralGrad)" stroke="#ed8936" stroke-width="2" filter="url(#shadow)"/>
  <rect x="470" y="260" width="380" height="35" rx="10" fill="#c05621"/>
  <rect x="470" y="285" width="380" height="10" fill="url(#unilateralGrad)"/>
  <text x="660" y="283" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="14" font-weight="bold">UNILATERAL MODEL (n=50)</text>

  <!-- Unilateral Variables -->
  <text x="490" y="320" fill="#fbd38d" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Input Variables:</text>

  <rect x="490" y="330" width="160" height="25" rx="4" fill="#2d3748" stroke="#4a5568" stroke-width="1"/>
  <text x="570" y="347" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="11">Age (years)</text>

  <rect x="660" y="330" width="160" height="25" rx="4" fill="#2d3748" stroke="#4a5568" stroke-width="1"/>
  <text x="740" y="347" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="11">MGMT Status</text>

  <rect x="490" y="360" width="160" height="25" rx="4" fill="#2d3748" stroke="#4a5568" stroke-width="1"/>
  <text x="570" y="377" text-anchor="middle" fill="#e2e8f0" font-family="Arial, sans-serif" font-size="11">EoR ≥95%</text>

  <rect x="575" y="390" width="170" height="25" rx="4" fill="#ed8936" stroke="#f6ad55" stroke-width="1"/>
  <text x="660" y="407" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11" font-weight="bold">IntraM1 Tumor (LL/UL)</text>

  <!-- Unilateral Formula -->
  <text x="490" y="435" fill="#fbd38d" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Logistic Regression:</text>
  <rect x="490" y="442" width="340" height="45" rx="4" fill="#1a202c" stroke="#2d3748" stroke-width="1"/>
  <text x="660" y="460" text-anchor="middle" fill="#68d391" font-family="Courier New, monospace" font-size="9">
    logit(p) = -0.79 - 0.03×Age + 0.12×MGMT
  </text>
  <text x="660" y="478" text-anchor="middle" fill="#68d391" font-family="Courier New, monospace" font-size="9">
    + 0.64×EoR95 + 1.92×IntraM1
  </text>

  <!-- Arrows to output -->
  <line x1="240" y1="500" x2="240" y2="530" stroke="#4299e1" stroke-width="2"/>
  <line x1="660" y1="500" x2="660" y2="530" stroke="#ed8936" stroke-width="2"/>
  <line x1="240" y1="530" x2="450" y2="530" stroke="#718096" stroke-width="2"/>
  <line x1="660" y1="530" x2="450" y2="530" stroke="#718096" stroke-width="2"/>
  <line x1="450" y1="530" x2="450" y2="550" stroke="#718096" stroke-width="2"/>

  <!-- Output Box -->
  <rect x="250" y="550" width="400" height="55" rx="8" fill="#4a5568" filter="url(#shadow)"/>
  <text x="450" y="573" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="13" font-weight="bold">12-MONTH SURVIVAL PROBABILITY</text>
  <text x="450" y="593" text-anchor="middle" fill="#a0aec0" font-family="Arial, sans-serif" font-size="11">p = 1 / (1 + e^(-logit))</text>

  <!-- Risk Categories -->
  <text x="450" y="625" text-anchor="middle" fill="#2d3748" font-family="Arial, sans-serif" font-size="12" font-weight="bold">RISK STRATIFICATION</text>

  <!-- Favorable -->
  <rect x="100" y="640" width="200" height="45" rx="6" fill="url(#greenGrad)" filter="url(#shadow)"/>
  <text x="200" y="660" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">FAVORABLE</text>
  <text x="200" y="677" text-anchor="middle" fill="#c6f6d5" font-family="Arial, sans-serif" font-size="11">≥70% survival probability</text>

  <!-- Intermediate -->
  <rect x="350" y="640" width="200" height="45" rx="6" fill="url(#yellowGrad)" filter="url(#shadow)"/>
  <text x="450" y="660" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">INTERMEDIATE</text>
  <text x="450" y="677" text-anchor="middle" fill="#fefcbf" font-family="Arial, sans-serif" font-size="11">40-69% survival probability</text>

  <!-- Poor -->
  <rect x="600" y="640" width="200" height="45" rx="6" fill="url(#redGrad)" filter="url(#shadow)"/>
  <text x="700" y="660" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">POOR</text>
  <text x="700" y="677" text-anchor="middle" fill="#fed7d7" font-family="Arial, sans-serif" font-size="11">&lt;40% survival probability</text>

  <!-- nTMS Metric Legends -->
  <rect x="70" y="505" width="12" height="12" fill="#4299e1"/>
  <text x="88" y="515" fill="#2d3748" font-family="Arial, sans-serif" font-size="9">nTMS Metric (Bilateral)</text>

  <rect x="490" y="505" width="12" height="12" fill="#ed8936"/>
  <text x="508" y="515" fill="#2d3748" font-family="Arial, sans-serif" font-size="9">nTMS Metric (Unilateral)</text>

  <!-- Key definitions box -->
  <rect x="680" y="85" width="170" height="80" rx="6" fill="#edf2f7" stroke="#cbd5e0" stroke-width="1"/>
  <text x="765" y="103" text-anchor="middle" fill="#2d3748" font-family="Arial, sans-serif" font-size="10" font-weight="bold">KEY DEFINITIONS</text>
  <text x="690" y="120" fill="#4a5568" font-family="Arial, sans-serif" font-size="8">CES: Cortical Excitability Score</text>
  <text x="690" y="133" fill="#4a5568" font-family="Arial, sans-serif" font-size="8">IntraM1: LL RMT / UL RMT ratio</text>
  <text x="690" y="146" fill="#4a5568" font-family="Arial, sans-serif" font-size="8">EoR: Extent of Resection</text>
  <text x="690" y="159" fill="#4a5568" font-family="Arial, sans-serif" font-size="8">RMT: Resting Motor Threshold</text>
</svg>
